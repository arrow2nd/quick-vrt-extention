class M{originalScrollBehavior=null;constructor(){this.init()}init(){this.setupMessageListener()}setupMessageListener(){chrome.runtime.onMessage.addListener((x,A,j)=>{return this.handleMessage(x,A,j),!0})}async handleMessage(x,A,j){try{switch(x.type){case"PREPARE_FOR_CAPTURE":await this.prepareForCapture(x.options),j({success:!0});break;case"SCROLL_TO_TOP":this.scrollToTop(),j({success:!0});break;case"SCROLL_TO_BOTTOM":await this.scrollToBottom(),j({success:!0});break;case"GET_PAGE_INFO":let B=this.getPageInfo();j({success:!0,data:B});break;case"DISABLE_ANIMATIONS":this.disableAnimations(),j({success:!0});break;case"RESTORE_PAGE":this.restorePage(),j({success:!0});break;default:j({success:!1,error:"Unknown message type"})}}catch(B){console.error("Content script メッセージ処理エラー:",B),j({success:!1,error:B.message})}}async prepareForCapture(x={}){try{if(x.disableAnimations)this.disableAnimations();if(x.autoScroll)await this.performFullPageScroll();else this.scrollToTop();if(x.waitForImages)await this.waitForImages();let A=x.stabilizationDelay||500;await new Promise((j)=>setTimeout(j,A))}catch(A){throw console.error("キャプチャ準備エラー:",A),A}}getPageInfo(){return{url:window.location.href,title:document.title,scrollHeight:document.documentElement.scrollHeight,scrollWidth:document.documentElement.scrollWidth,viewport:{width:window.innerWidth,height:window.innerHeight},hasLazyImages:this.hasLazyLoadingImages(),hasAnimations:this.hasAnimations()}}scrollToTop(){window.scrollTo({top:0,left:0,behavior:"auto"})}async scrollToBottom(x=300){let A=document.documentElement.scrollHeight,j=window.innerHeight,B=0;while(B<A)if(B+=j,window.scrollTo({top:B,behavior:"auto"}),await new Promise((G)=>setTimeout(G,x)),document.documentElement.scrollHeight>A)break;this.scrollToTop(),await new Promise((F)=>setTimeout(F,x))}async performFullPageScroll(){try{let x=document.documentElement.scrollHeight;await this.scrollToBottom(200),await this.triggerLazyLoading(),this.scrollToTop(),await new Promise((A)=>setTimeout(A,300))}catch(x){console.error("フルページスクロールエラー:",x),this.scrollToTop()}}async triggerLazyLoading(){let x=["img[data-src]","img[data-srcset]",'img[loading="lazy"]',"picture[data-src]","source[data-srcset]","[data-bg]","[data-background]","[data-background-image]",".lazy",".lazyload",".lazy-load"];x.forEach((j)=>{document.querySelectorAll(j).forEach((F)=>{let G=F,J=F;if(G.dataset.src&&!J.src)J.src=G.dataset.src;if(G.dataset.srcset&&!J.srcset)J.srcset=G.dataset.srcset;if(J.loading==="lazy")J.loading="eager";let K=G.dataset.bg||G.dataset.background||G.dataset.backgroundImage;if(K)G.style.backgroundImage=`url(${K})`})}),document.querySelectorAll(x.join(",")).forEach((j)=>{j.scrollIntoView({behavior:"auto",block:"center"})}),await this.waitForImages(3000)}async waitForImages(x=5000){let A=Array.from(document.images).filter((j)=>!j.complete);if(A.length===0)return;return new Promise((j)=>{let B=0,F=A.length,G=setTimeout(j,x),J=()=>{if(B++,B>=F)clearTimeout(G),j()};A.forEach((K)=>{if(K.complete)J();else K.addEventListener("load",J,{once:!0}),K.addEventListener("error",J,{once:!0})})})}disableAnimations(){let x=document.createElement("style");x.id="quick-vrt-disable-animations",x.innerHTML=`
      *, *::before, *::after {
        animation-duration: 0s !important;
        animation-delay: 0s !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0s !important;
        transition-delay: 0s !important;
        transition-property: none !important;
      }
      
      /* 一般的なアニメーションライブラリのクラスを無効化 */
      .animate__animated,
      .animated,
      [class*="animate-"],
      [class*="fade"],
      [class*="slide"],
      [class*="bounce"],
      [class*="zoom"],
      [class*="rotate"],
      [class*="flip"] {
        animation: none !important;
        transition: none !important;
      }
    `,document.head.appendChild(x),this.disableJavaScriptAnimations(),this.originalScrollBehavior=document.documentElement.style.scrollBehavior,document.documentElement.style.scrollBehavior="auto"}disableJavaScriptAnimations(){let x=window.requestAnimationFrame;window.requestAnimationFrame=function(j){return setTimeout(j,0)};let A=window.setTimeout;window.setTimeout=function(j,B,...F){let G=B&&B<100?0:B;return A(j,G,...F)},this.disableAnimationLibraries()}disableAnimationLibraries(){let x=window.jQuery||window.$;if(x){if(x.fx)x.fx.off=!0}let A=window.gsap;if(A)try{A.globalTimeline.pause()}catch(F){console.warn("GSAP制御エラー:",F)}let j=window.anime;if(j&&j.running)try{j.running.forEach((F)=>F.pause())}catch(F){console.warn("Anime.js制御エラー:",F)}let B=window.Velocity;if(B)try{B.mock=!0}catch(F){console.warn("Velocity.js制御エラー:",F)}}restorePage(){let x=document.getElementById("quick-vrt-disable-animations");if(x)x.remove();if(this.originalScrollBehavior!==null)document.documentElement.style.scrollBehavior=this.originalScrollBehavior;this.scrollToTop()}hasLazyLoadingImages(){return["img[data-src]","img[data-srcset]",'img[loading="lazy"]',".lazy",".lazyload"].some((A)=>document.querySelector(A)!==null)}hasAnimations(){if(document.querySelectorAll('[class*="animate"], [class*="animation"], .animated').length>0)return!0;let A=document.querySelectorAll("*");for(let j=0;j<Math.min(A.length,50);j++){let B=window.getComputedStyle(A[j]);if(B.animationDuration!=="0s"||B.transitionDuration!=="0s")return!0}return!1}async waitForPageStability(x=3000){return new Promise((A)=>{let j,B=document.documentElement.scrollHeight,F=0,G=5;j=setInterval(()=>{let K=document.documentElement.scrollHeight;if(K===B){if(F++,F>=G)clearInterval(j),A()}else F=0,B=K},200),setTimeout(()=>{clearInterval(j),A()},x)})}}if(typeof window!=="undefined")new M;

//# debugId=A94147832FCD3B4464756E2164756E21
//# sourceMappingURL=content.js.map
